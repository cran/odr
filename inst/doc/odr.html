<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zuchao Shen &amp; Benjamin Kelcey" />

<meta name="date" content="2025-10-31" />

<title>Package ‘odr’</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Package ‘odr’</h1>
<h4 class="author">Zuchao Shen &amp; Benjamin Kelcey</h4>
<h4 class="date">2025-10-31</h4>



<p>The costs of sampling each additional unit in (multilevel)
experimental studies vary across treatment conditions (and levels of
hierarchy). This package is a tool to identify the optimal sample
allocation in experimental studies such that statistical power is
maximized under a fixed budget. The designs covers experiments detecting
main, mediation, and moderation effects (and some of the
combinations).</p>
<div id="optimal-design-parameters" class="section level1">
<h1>1. Optimal Design Parameters</h1>
<p>Optimal design parameters in an optimal sample allocation include</p>
<ul>
<li>the optimal sample sizes at each of the levels except the top level
because the top-level sample size will be determined by total budget or
power once all other parameters are decided, and</li>
<li>the proportion of units assigned to the treatment condition at the
level of randomization.</li>
</ul>
<p>Researchers can fix one or more of the optimal design parameters for
constrained optimal sample allocation and solve for the remainder of
optimal design parameters.</p>
</div>
<div id="designs-detecting-main-effects" class="section level1">
<h1>2. Designs Detecting Main Effects</h1>
<div id="designs-and-functions" class="section level2">
<h2>Designs and Functions</h2>
<table>
<caption>Functions for Designs Detecting Main Effects</caption>
<thead>
<tr class="header">
<th align="left">Design</th>
<th align="left">OD Function</th>
<th align="left">Power Function</th>
<th align="left">RE Function</th>
<th align="left">NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Simple Experiments</td>
<td align="left">od.1</td>
<td align="left">plot.power</td>
<td align="left">power.1</td>
<td align="left">re</td>
</tr>
<tr class="even">
<td align="left">2-Level CRTs</td>
<td align="left">od.2</td>
<td align="left">plot.power</td>
<td align="left">power.2</td>
<td align="left">re</td>
</tr>
<tr class="odd">
<td align="left">2-Level MRTs</td>
<td align="left">od.2m</td>
<td align="left">plot.power</td>
<td align="left">power.2m</td>
<td align="left">re</td>
</tr>
<tr class="even">
<td align="left">3-Level CRTs</td>
<td align="left">od.3</td>
<td align="left">plot.power</td>
<td align="left">power.3</td>
<td align="left">re</td>
</tr>
<tr class="odd">
<td align="left">3-Level MRTs</td>
<td align="left">od.3m</td>
<td align="left">plot.power</td>
<td align="left">power.3m</td>
<td align="left">re</td>
</tr>
</tbody>
</table>
</div>
<div id="rules-for-function-names" class="section level2">
<h2>Rules for Function Names</h2>
<p>For experiments detecting main effects, this package includes four
categorical of functions and they are <em>od</em>, <em>plot.power</em>,
<em>power</em>, and <em>re</em>. For <em>od</em> and <em>power</em>
functions, if a function name follows .# (e.g., od.2), this function is
for #-level designs with treatment assignment at the top level (# in 1,
2, 3). If a function name follows .#m (e.g., od.2m), this function is
for #-level multisite-randomized trials.</p>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<div id="od-function" class="section level3">
<h3><em>od</em> function</h3>
<p>This function calculates optimal sample allocation parameters with
and without constraint(s). For each type of multilevel experimental
studies, there is an additional number (and one additional letter m) to
be added to the general function name. For example, the function for
two-level cluster randomized trials is <em>od.2</em>, the function for
two-level multisite randomized trials is <em>od.2m</em>.</p>
</div>
<div id="power-function" class="section level3">
<h3><em>power</em> function</h3>
<p>This function performs power analyses with and without accommodating
cost structures of sampling. For power analysis accommodating cost
structures, depending on which one parameter is left, the function
calculates required budget (and sample size), statistical power, and
minimum detectable effect size. For conventional power analysis without
accommodating cost structures of sampling, this function calculates
required sample size, statistical power, and minimum detectable effect
size. For each type of experiments, there is an additional number (and
an additional letter m) to be added to the general function name. For
example, the function for two-level cluster randomized trials is
<em>power.2</em>, the function for two-level multisite randomized trials
is <em>power.2m</em>.</p>
</div>
<div id="re-function" class="section level3">
<h3><em>re</em> function</h3>
<p>This function calculates relative efficiency values between two
designs. An alternative name for this function is <em>rpe</em> that
stands for “relative precision and efficiency”.</p>
</div>
</div>
</div>
<div id="designs-detecting-mediation-effects" class="section level1">
<h1>3. Designs Detecting Mediation Effects</h1>
<div id="designs-and-functions-1" class="section level2">
<h2>Designs and Functions</h2>
<table>
<caption>Functions for Designs Detecting Mediation Effects (In
Preparation)</caption>
<thead>
<tr class="header">
<th align="left">Design</th>
<th align="left">OD Function</th>
<th align="left">Power Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Simple Experiments</td>
<td align="left">od.1.111</td>
<td align="left">power.1.111</td>
</tr>
<tr class="even">
<td align="left">2-Level CRTs</td>
<td align="left">od.2.221</td>
<td align="left">power.2.221</td>
</tr>
<tr class="odd">
<td align="left">2-Level MRTs</td>
<td align="left">od.2m.111</td>
<td align="left">power.2m.111</td>
</tr>
</tbody>
</table>
</div>
<div id="rules-for-function-names-1" class="section level2">
<h2>Rules for Function Names</h2>
<p>There are two categories of functions for designs detecting mediation
effects. They are <em>od</em> and <em>power</em> functions. The function
names follow additional rules as these functions will add additional
numbers to represent the levels of the treatment assignment, the
mediator and the outcome. For example, <em>od.2.221</em> is the
<em>od</em> function for two-level cluster-randomized trials (.2) with
the treatment assignment and the mediator at the level two, and the
outcome at the level 1 (.221). <em>od.2m.111</em> is the <em>od</em>
function for two-level multisite-randomized trials (.2m) with the
treatment assignment, the mediator, and the outcome at the level one
(.111).</p>
</div>
<div id="functions-1" class="section level2">
<h2>Functions</h2>
<p>There are two categorical functions for designs detecting mediation
effects and they are <em>od</em> and <em>power</em>. <em>od</em>
function can calculate optimal design parameters with and without a
constraint(s). <em>power</em> function can perform power analysis.</p>
</div>
</div>
<div id="designs-detecting-moderation-and-main-effects" class="section level1">
<h1>4. Designs Detecting Moderation (and Main) Effects</h1>
<div id="designs-and-functions-2" class="section level2">
<h2>Designs and Functions</h2>
<table>
<caption>Functions for Designs Detecting Moderation Effects (In
Preparation)</caption>
<thead>
<tr class="header">
<th align="left">Design</th>
<th align="left">OD Function</th>
<th align="left">Power Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Simple Experiments</td>
<td align="left">od.1.111m</td>
<td align="left">power.1.111m</td>
</tr>
<tr class="even">
<td align="left">2-Level CRTs</td>
<td align="left">od.2.221m</td>
<td align="left">power.2.221m</td>
</tr>
<tr class="odd">
<td align="left">2-Level MRTs</td>
<td align="left">od.2m.111m</td>
<td align="left">power.2m.111m</td>
</tr>
</tbody>
</table>
</div>
<div id="rules-for-function-names-2" class="section level2">
<h2>Rules for Function Names</h2>
<p>There are two categories of functions for designs detecting
moderation effects. They are <em>od</em> and <em>power</em> functions.
The function names follow additional rules as these functions will add
additional numbers to represent the levels of the treatment assignment,
the moderator and the outcome. For example, <em>od.2.221m</em> is the
<em>od</em> function for two-level cluster-randomized trials (.2) with
the treatment assignment and the moderator at the level two, and the
outcome at the level 1 (.221), and for moderators (m) rather than for
mediators. <em>od.2m.111m</em> is the <em>od</em> function for two-level
multisite-randomized trials (.2m) with the treatment assignment, the
moderator, and the outcome at the level one (.111) for moderators
(m).</p>
</div>
<div id="functions-2" class="section level2">
<h2>Functions</h2>
<p>There are two categorical functions for designs detecting mediation
effects and they are <em>od</em> and <em>power</em>. <em>od</em>
function can calculate optimal design parameters with and without a
constraint(s). <em>power</em> function can perform power analysis.</p>
</div>
</div>
<div id="examples-for-main-effects" class="section level1">
<h1>5. Examples for Main Effects</h1>
<div id="function-od" class="section level2">
<h2>Function <em>od</em></h2>
<p>Given cost structure (i.e., the costs of sampling each unit at
different levels and treatment conditions), this function solves the
optimal sample allocation with and without constraints.</p>
<p>To solve the optimal sample allocation of a two-level
cluster-randomized trial, we need the following information</p>
<ul>
<li>icc: intraclass correlation coefficient</li>
<li>r12: the proportion of level-one outcome variance explained by
covariates</li>
<li>r22: the proportion of level-two outcome variance explained by
covariates</li>
<li>c1: the cost of sampling each additional level-one unit in the
control condition</li>
<li>c2: the cost of sampling each additional level-two unit in the
control condition</li>
<li>c1t: the cost of sampling each additional level-one unit in the
experimental condition</li>
<li>c2t: the cost of sampling each additional level-two unit in the
experimental condition</li>
<li>m: a total fixed budget used to plot the variance curves, default
value is the cost of sampling 60 level-two units across treatment
conditions.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(odr)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a> <span class="co"># unconstrained optimal design</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>myod1 <span class="ot">&lt;-</span> <span class="fu">od.2</span>(<span class="at">icc =</span> <span class="fl">0.2</span>, <span class="at">r12 =</span> <span class="fl">0.5</span>, <span class="at">r22 =</span> <span class="fl">0.5</span>, <span class="at">c1 =</span> <span class="dv">1</span>, <span class="at">c2 =</span> <span class="dv">5</span>, <span class="at">c1t =</span> <span class="dv">1</span>, <span class="at">c2t =</span> <span class="dv">50</span>, </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>              <span class="at">varlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.02</span>))</span></code></pre></div>
<pre><code>## The optimal level-1 sample size per level-2 unit (n) is 8.878572.
## The optimal proportion of level-2 units in treatment (p) is 0.326828.</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a> <span class="co"># The function by default prints messages of output and plots the variance curves; one can turn off message and specify one or no plot.</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a> <span class="co"># myod1$out # output; </span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a> <span class="co"># myod1$par # parameters used in the calculation.</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a> <span class="co"># constrained optimal design with n = 20</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>myod2 <span class="ot">&lt;-</span> <span class="fu">od.2</span>(<span class="at">icc =</span> <span class="fl">0.2</span>, <span class="at">r12 =</span> <span class="fl">0.5</span>, <span class="at">r22 =</span> <span class="fl">0.5</span>, <span class="at">c1 =</span> <span class="dv">1</span>, <span class="at">c2 =</span> <span class="dv">5</span>, <span class="at">c1t =</span> <span class="dv">1</span>, </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>              <span class="at">c2t =</span> <span class="dv">50</span>, <span class="at">plot.by =</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="st">&quot;p&quot;</span>), <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>              <span class="at">varlim =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.030</span>))</span></code></pre></div>
<pre><code>## The constrained level-1 sample size per level-2 unit (n) is 20.
## The optimal proportion of level-2 units in treatment (p) is 0.3740667.</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a> <span class="co"># myod2$out # output</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a> <span class="co"># myod2$par # parameters used in the calculation.</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a> <span class="co"># constrained optimal design with p = 0.5</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>myod3 <span class="ot">&lt;-</span> <span class="fu">od.2</span>(<span class="at">icc =</span> <span class="fl">0.2</span>, <span class="at">r12 =</span> <span class="fl">0.5</span>, <span class="at">r22 =</span> <span class="fl">0.5</span>, <span class="at">c1 =</span> <span class="dv">1</span>, <span class="at">c2 =</span> <span class="dv">5</span>, <span class="at">c1t =</span> <span class="dv">1</span>, <span class="at">c2t =</span> <span class="dv">50</span>, </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>             <span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">varlim =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.020</span>))</span></code></pre></div>
<pre><code>## The optimal level-1 sample size per level-2 unit (n) is 10.48809.
## The constrained proportion of level-2 units in treatment (p) is 0.5.</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a> <span class="co"># myod3$out # output; </span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a> <span class="co"># myod3$par # parameters used in the calculation.</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a> <span class="co"># constrained n and p, no calculation performed</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>myod4 <span class="ot">&lt;-</span> <span class="fu">od.2</span>(<span class="at">icc =</span> <span class="fl">0.2</span>, <span class="at">r12 =</span> <span class="fl">0.5</span>, <span class="at">r22 =</span> <span class="fl">0.5</span>, <span class="at">c1 =</span> <span class="dv">1</span>, <span class="at">c2 =</span> <span class="dv">5</span>, <span class="at">c1t =</span> <span class="dv">1</span>, <span class="at">c2t =</span> <span class="dv">50</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>              <span class="at">plots =</span> <span class="cn">FALSE</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">varlim =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.025</span>))</span></code></pre></div>
<pre><code>## ===============================
## Both p and n are constrained, there is no calculation from other parameters.
## ===============================
## The constrained level-1 sample size per level-2 unit (n) is 20.
## The constrained proportion of level-2 units in treatment (p) is 0.5.</code></pre>
<p>Please see additional examples in corresponding functions by
uncommenting below lines.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># ?od.1 </span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># ?od.3</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co"># ?od.4</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># ?od.2m</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># ?od.3m</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co"># ?od.4m</span></span></code></pre></div>
</div>
<div id="function-plot.power" class="section level2">
<h2>Function <em>plot.power</em></h2>
<p>This function plots the statistical power curves for the identified
optimal sample allocation. It takes the output from an <em>od</em>
function as the key inputs. Other arguments include</p>
<ul>
<li>q: the number of covariates at the proper level, which depends on
the type of the design</li>
<li>d: standardized main treatment effect</li>
<li>power: the power level for the main effect</li>
<li>other parameters that vary across designs</li>
</ul>
<p>The function will first calculate the required budget to achieve the
target power level (80%) if the budget is not explicitly specified.
Then, it calculate the power under different allocations under the same
budget and plot the power curve(s) against the sample allocations.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>myplot <span class="ot">&lt;-</span> <span class="fu">plot.power</span>(<span class="at">expr =</span> myod1, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">d =</span> .<span class="dv">1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>myplot</span></code></pre></div>
<pre><code>## $mfrow
## [1] 1 1</code></pre>
</div>
<div id="function-power" class="section level2">
<h2>Function <em>power</em></h2>
<p>This function by default can perform power analyses accommodating
cost structures (i.e., cost.model = TRUE), one of ‘power’, ‘m’, and ‘d’
must be NULL. For example, if ‘power’ is NULL, the function calculates
statistical power under a fixed budget and cost structure; if ‘d’ is
NULL, the function calculates minimum detectable effect size (i.e., d)
under a fixed budget and desired power level; if ‘m’ is NULL, the
function calculate required budget (and required sample size) to achieve
desired power level to detect a treatment effect.</p>
<p>This function also can conduct conventional power analysis or power
analysis without accommodating cost structures by specifying cost.model
= FALSE, the conventional power analyses include statistical power
calculation, minimum detectable effect size calculation, and required
sample size calculation.</p>
<div id="examples-of-power-analyses-accommodating-cost-structures-cost.model-true" class="section level3">
<h3>Examples of power analyses accommodating cost structures (cost.model
= TRUE)</h3>
<div id="required-budget-for-desired-power" class="section level6">
<h6>Required budget for desired power</h6>
<ul>
<li>Required budget calculation</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>mym <span class="ot">&lt;-</span> <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">power =</span> <span class="fl">0.8</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># mym$out  # m =1702, J = 59</span></span></code></pre></div>
<ul>
<li>Effects on required budget to maintain same level power when designs
depart from the optimal one</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>figure <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>budget <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>nrange <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> nrange)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  budget <span class="ot">&lt;-</span> <span class="fu">c</span>(budget, <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">constraint =</span> <span class="fu">list</span> (<span class="at">n =</span> n), <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">power =</span> <span class="fl">0.8</span>)<span class="sc">$</span>out<span class="sc">$</span>m)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">plot</span>(nrange, budget, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1500</span>, <span class="dv">3500</span>),</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Level-1 sample size: n&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Budget&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">9</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;Blue&quot;</span>)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a> </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>budget <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>prange <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.005</span>)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> prange)</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>  budget <span class="ot">&lt;-</span> <span class="fu">c</span>(budget, <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">constraint =</span> <span class="fu">list</span> (<span class="at">p =</span> p), <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">power =</span> <span class="fl">0.8</span>)<span class="sc">$</span>out<span class="sc">$</span>m)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="fu">plot</span>(prange, budget, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1500</span>, <span class="dv">7000</span>),</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Porportion groups in treatment: p&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Budget&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.33</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;Blue&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">par</span>(figure)</span></code></pre></div>
</div>
<div id="statistical-power-under-a-fixed-budget" class="section level6">
<h6>Statistical power under a fixed budget</h6>
<ul>
<li>Power calculation</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>mypower <span class="ot">&lt;-</span> <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">m =</span> <span class="dv">1702</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co"># mypower$out  # power = 0.80</span></span></code></pre></div>
<ul>
<li>Effects on power under same budget when designs depart from the
optimal one</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>figure <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span> (<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>nrange <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> nrange)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  pwr <span class="ot">&lt;-</span> <span class="fu">c</span>(pwr, <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">constraint =</span> <span class="fu">list</span> (<span class="at">n =</span> n), <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">1702</span>)<span class="sc">$</span>out)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="fu">plot</span>(nrange, pwr, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.9</span>),</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Level-1 sample size: n&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Power&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">9</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;Blue&quot;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a> </span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>prange <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.005</span>)</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> prange)</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  pwr <span class="ot">&lt;-</span> <span class="fu">c</span>(pwr, <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">constraint =</span> <span class="fu">list</span> (<span class="at">p =</span> p), <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">1702</span>)<span class="sc">$</span>out)</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="fu">plot</span>(prange, pwr, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>),</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Porportion groups in treatment: p&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Power&quot;</span>,  <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.33</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;Blue&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a> <span class="fu">par</span>(figure)</span></code></pre></div>
</div>
<div id="minimum-detectable-effect-size-under-a-fixed-budget" class="section level6">
<h6>Minimum detectable effect size under a fixed budget</h6>
<ul>
<li>minimum detectable effect size calculation</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>mymdes <span class="ot">&lt;-</span> <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">power =</span> <span class="fl">0.80</span>, <span class="at">m =</span> <span class="dv">1702</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co"># above experssion takes parameters and outputs from od.2 function. Equivalently, each parameter can be explicitly specified.</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co"># mym &lt;- power.2(icc = 0.2, r12 = 0.5, r22 = 0.5, c1 = 1, c2 = 5, c1t = 1, c2t = 50,</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#                     n = 9, p = 0.33, d = 0.3, q = 1, power = 0.8)</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co"># mymdes$out  # d = 0.30</span></span></code></pre></div>
<ul>
<li>Effects on minimum detectable effect size under same budget when
designs depart from the optimal one</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>figure <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span> (<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>MDES <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>nrange <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> nrange)</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  MDES <span class="ot">&lt;-</span> <span class="fu">c</span>(MDES, <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">constraint =</span> <span class="fu">list</span> (<span class="at">n =</span> n), <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">1702</span>)<span class="sc">$</span>out)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="fu">plot</span>(nrange, MDES, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>),</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Level-1 sample size: n&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;MDES&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">9</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;Blue&quot;</span>)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a> </span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>MDES <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>prange <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.005</span>)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> prange)</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  MDES <span class="ot">&lt;-</span> <span class="fu">c</span>(MDES, <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">constraint =</span> <span class="fu">list</span> (<span class="at">p =</span> p), <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">m =</span> <span class="dv">1702</span>)<span class="sc">$</span>out)</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="fu">plot</span>(prange, MDES, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>),</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Porportion groups in treatment: p&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;MDES&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.33</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;Blue&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a> <span class="fu">par</span>(figure)</span></code></pre></div>
</div>
</div>
<div id="examples-of-conventional-power-analyses-cost.model-false" class="section level3">
<h3>Examples of conventional power analyses (cost.model = FALSE)</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Required level-2 sample size calculation</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>myJ <span class="ot">&lt;-</span> <span class="fu">power.2</span>(<span class="at">cost.model =</span> <span class="cn">FALSE</span>, <span class="at">expr =</span> myod1, <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">power =</span> <span class="fl">0.8</span>)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co"># above experssion takes parameters and outputs from od.2 function. Equivalently, each parameter can be explicitly specified.</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># myJ &lt;- power.2(icc = 0.2, r12 = 0.5, r22 = 0.5, </span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#                     cost.model = FALSE, n = 9, p = 0.33, d = 0.3, q = 1, power = 0.8)</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>myJ<span class="sc">$</span>out  <span class="co"># J = 59</span></span></code></pre></div>
<pre><code>## $J
## [1] 58.99295</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Power calculation</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>mypower1 <span class="ot">&lt;-</span> <span class="fu">power.2</span>(<span class="at">cost.model =</span> <span class="cn">FALSE</span>, <span class="at">expr =</span> myod1, <span class="at">J =</span> <span class="dv">59</span>, <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>mypower1<span class="sc">$</span>out  <span class="co"># power = 0.80</span></span></code></pre></div>
<pre><code>## $power
## [1] 0.8000486</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Minimum detectable effect size calculation</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>mymdes1 <span class="ot">&lt;-</span> <span class="fu">power.2</span>(<span class="at">cost.model =</span> <span class="cn">FALSE</span>, <span class="at">expr =</span> myod1, <span class="at">J =</span> <span class="dv">59</span>, <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">q =</span> <span class="dv">1</span>)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>mymdes1<span class="sc">$</span>out  <span class="co"># d = 0.30</span></span></code></pre></div>
<pre><code>## $d
## [1] 0.2999819</code></pre>
</div>
<div id="examples-of-conventional-power-curves" class="section level3">
<h3>Examples of conventional power curves</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>figure <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span> (<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>mrange <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">300</span><span class="sc">:</span><span class="dv">3000</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="cf">for</span> (m <span class="cf">in</span> mrange)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  pwr <span class="ot">&lt;-</span> <span class="fu">c</span>(pwr, <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">m =</span> m)<span class="sc">$</span>out)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="fu">plot</span>(mrange, pwr, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">3000</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Budget&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Power&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">1702</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;Blue&quot;</span>)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a> </span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>Jrange <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="cf">for</span> (J <span class="cf">in</span> Jrange)</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>  pwr <span class="ot">&lt;-</span> <span class="fu">c</span>(pwr, <span class="fu">power.2</span>(<span class="at">expr =</span> myod1, <span class="at">cost.model =</span> <span class="cn">FALSE</span>, <span class="at">d =</span> <span class="fl">0.3</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">J =</span> J)<span class="sc">$</span>out)</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a><span class="fu">plot</span>(Jrange, pwr, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">100</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Level-2 sample size: J&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Power&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a> <span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">59</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;Blue&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">par</span>(figure)</span></code></pre></div>
</div>
<div id="examples-for-other-types-of-trials" class="section level3">
<h3>Examples for other types of trials</h3>
<p>Please see examples in corresponding functions by uncommenting below
lines.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># ?power.1</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="co"># ?power.3</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co"># ?power.4</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co"># ?power.2m</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="co"># ?power.3m</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co"># ?power.4m</span></span></code></pre></div>
</div>
</div>
<div id="function-re" class="section level2">
<h2>Function <em>re</em></h2>
<p>Calculate the relative efficiency (RE) of two designs, this function
uses the returns from <em>od</em> function</p>
<p>Based on above examples in <em>od</em> functions, calculate the
relative efficiency</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># relative efficiency (RE) of a constrained design comparing with the optimal design</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>myre <span class="ot">&lt;-</span> <span class="fu">re</span>(<span class="at">od =</span> myod1, <span class="at">subod=</span> myod2)</span></code></pre></div>
<pre><code>## The relative efficiency (RE) of the two two-level CRTs is 0.8790305.</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>myre<span class="sc">$</span>re <span class="co"># get the output (i.e., RE = 0.88)</span></span></code></pre></div>
<pre><code>## [1] 0.8790305</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># relative efficiency (RE) of a constrained design comparing with the unconstrained optimal one</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>myre <span class="ot">&lt;-</span> <span class="fu">re</span>(<span class="at">od =</span> myod1, <span class="at">subod=</span> myod3)</span></code></pre></div>
<pre><code>## The relative efficiency (RE) of the two two-level CRTs is 0.8975086.</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># relative efficiency (RE) of a constrained design comparing with the unconstrained optimal one</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>myre <span class="ot">&lt;-</span> <span class="fu">re</span>(<span class="at">od =</span> myod1, <span class="at">subod=</span> myod4)</span></code></pre></div>
<pre><code>## The relative efficiency (RE) of the two two-level CRTs is 0.8266527.</code></pre>
<p>For additional examples, please see example sections in corresponding
<em>od</em> functions by uncommenting below lines.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># ?od.1</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="co"># ?od.2</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="co"># ?od.3</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="co"># ?od.4</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="co"># ?od.2m</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a><span class="co"># ?od.3m</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="co"># ?od.4m</span></span></code></pre></div>
</div>
</div>
<div id="examples-for-mediation-effects" class="section level1">
<h1>6. Examples for Mediation Effects</h1>
<p>Below is a simple example to identify an optimal sample allocation
and perform statistical power analyses for a mediation effect.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># Optimal sample allocation and statistical power for randomized controlled trials</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>myod <span class="ot">&lt;-</span> <span class="fu">od.1.111</span>(<span class="at">a =</span> .<span class="dv">3</span>, <span class="at">b =</span> .<span class="dv">5</span>, <span class="at">c1 =</span> <span class="dv">10</span>, <span class="at">c1t =</span> <span class="dv">100</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>mypower <span class="ot">&lt;-</span> <span class="fu">power.1.111</span>(<span class="at">expr =</span> myod, <span class="at">power =</span> .<span class="dv">8</span>)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="co"># mypower</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="co"># Conventional power analyses</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>mypower <span class="ot">&lt;-</span> <span class="fu">power.1.111</span>(<span class="at">cost.model =</span> <span class="cn">FALSE</span>, <span class="at">a =</span> .<span class="dv">3</span>, <span class="at">b =</span> .<span class="dv">5</span>, <span class="at">test =</span> <span class="st">&quot;joint&quot;</span>,</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>                        <span class="at">power =</span> .<span class="dv">8</span>, <span class="at">p =</span>.<span class="dv">5</span>)</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a><span class="co"># mypower</span></span></code></pre></div>
</div>
<div id="examples-for-moderation-effects" class="section level1">
<h1>7. Examples for Moderation Effects</h1>
<p>To be done!</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
